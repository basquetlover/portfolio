---
import Background from "@components/Background.astro";
import Footer from "@components/Footer.astro";
import Menu from "@components/panel/Menu.astro";
import MenuMob from "@components/MenuMob.astro";
import Analytics from '@vercel/analytics/astro'
import { verificarSesion } from "@utils/usuario";
import ErrorSesion from "@components/ErrorSesion.astro";
import Hero from "@components/panel/Hero.astro";
interface Props {
	title: string;
	
}

const { title } = Astro.props;

let usuario = await verificarSesion(Astro.request);
---
<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/developer-logo.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="author" content="Pere Alemany Tomàs">
		<meta name="description" content="Portfolio de Pere Alemany, desarrollador full-stack. Proyectos web modernos con React, Astro, Tailwind, Supabase y más." />
		<meta name="theme-color" content="#c23a97" />
		<!-- Open Graph Meta Tags -->
		<meta property="og:title" content={title} />
		<meta property="og:description" content="Portfolio de Pere Alemany, desarrollador full-stack. Proyectos web modernos con React, Astro, Tailwind, Supabase y más." />
		<meta property="og:image" content="/og_porfolio.png" />
		<meta property="og:url" content={Astro.site} />
		<meta property="og:site_name" content="Pere Alemany | Full-Stack Developer" />
		<meta property="og:type" content="website" />
		<meta property="og:locale" content="es_ES" />

		<!-- Twitter Meta Tags -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content="Portfolio de Pere Alemany, desarrollador full-stack. Proyectos web modernos con React, Astro, Tailwind, Supabase y más." />
		<meta name="twitter:image" content="/og_porfolio.png" />
		<script src="/scripts/analytics.js" defer></script>
	</head>
	<body class="bg-azul overflow-hidden text-blanco fill-blanco">
		<Analytics/>
        {
            usuario ? (<>
                <div class="h-dvh grid grid-cols-[auto_1fr] grid-rows-[auto_1fr] overflow-hidden">
					<div class="col-span-2 flex flex-row items-center gap-x-4 w-[98%] mx-auto border-magenta border-b-2">
						<span id="btn-MenuDesktop" class="w-max h-max p-2 hover:bg-rosa/50 rounded-full cursor-pointer">
							<svg xmlns="http://www.w3.org/2000/svg" class="w-9 h-9" viewBox="0 -960 960 960">
								<path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"/>
							</svg>
						</span>
						<Hero />
					</div>

					<div id="MenuDesktop" class="row-start-2 flex relative items-center place-content-center">
						<div class="h-[98%]">
							<Menu />
						</div>
					</div>

					<div class="row-start-2 col-start-2 grid grid-rows-[1fr_auto] overflow-y-auto min-h-0">
						<main class="w-full mx-auto ">
							<slot />
						</main>
						<Footer />
					</div>
				</div>

            </>):(<>
                <div class="grid min-h-dvh grid-rows-[auto_1fr_auto]">
                    <div class="sm:block hidden">
                        <Menu />
                    </div>
                    <div class="sm:hidden block">
                        <MenuMob />
                    </div>
                    <main class="w-full  mx-auto">
                        <ErrorSesion />
                    </main>
                    <Footer />
                </div>
            </>)
        }
        
	</body>
</html>
<script>
	const btnMenuDesktop = document.getElementById('btn-MenuDesktop')!;
	const menuDesktop = document.getElementById('MenuDesktop')!;

	btnMenuDesktop.addEventListener('click', () => {
		if (menuDesktop.classList.contains('hidden')) {
			menuDesktop.classList.remove('hidden');
			menuDesktop.classList.add('flex');
		} else {
			menuDesktop.classList.add('hidden');
			menuDesktop.classList.remove('flex');
		}
	});
</script>
<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}

	/* *::selection{
		background-color: #c23a97 ;
		text:white;
	} */
	*::-moz-selection {
  background: #fb8ad7;
  color: #fff;
}

*::selection {
  background: #fb8ad7;
  color: #fff;
}

</style>
